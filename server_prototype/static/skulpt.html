<html>
    <head>
        <script src="http://www.skulpt.org/static/skulpt.min.js" type="text/javascript"></script>
    </head>

    <body>

        <script type="text/javascript">
         function outf(text) {
             var mypre = document.getElementById("output");
             mypre.innerHTML = mypre.innerHTML + text;
         }

         Sk.builtins.test = new Sk.builtin.func(function() {
             var returnMsg;
             var susp = new Sk.misceval.Suspension();
             susp.resume = function() {
                 return returnMsg || Sk.builtin.none.none$;
             }
             susp.data = {type: "Sk.promise", promise: new Promise(function(resolve) {
                 setTimeout(function() {
                     returnMsg = "hello from JavaScript";
                     resolve();
                 }, 3000);
             })};
             return susp;
         });

         Sk.builtins.alert = new Sk.builtin.func(function(msg) {
             console.log(msg);
             window.alert(msg);
         });

         function runit() {
             var prog = document.getElementById("yourcode").value;
             var mypre = document.getElementById("output");

             mypre.innerHTML = '';
             /* Sk.pre = "output"; */

             Sk.configure({output:outf});
             var myPromise = Sk.misceval.asyncToPromise(function() {
                 return Sk.importMainWithBody("<stdin>", false, prog, true);
             });
             myPromise.then(function(mod) {
                 console.log('success');
             }, function(err) {
                 console.log(err.toString());
             });
         }
        </script>

        <h3>Try This</h3>
        <form>
            <textarea id="yourcode" cols="40" rows="10">
print test()
            </textarea><br />
            <button type="button" onclick="runit()">Run</button>
        </form>
        <pre id="output"></pre>

    </body>

</html>
